{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/javierlopez/Desktop/Projects/hiMate/screens/ChatScreen.js\";\n\nimport React, { useLayoutEffect, useState } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport { AntDesign, SimpleLineIcons, Ionicons } from \"@expo/vector-icons\";\nimport { auth, db } from \"../firebase\";\nimport { Avatar } from 'react-native-elements';\nimport firebase from \"firebase\";\n\nvar ChatScreen = function ChatScreen(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      inputMessage = _useState2[0],\n      setInputMessage = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      messages = _useState4[0],\n      setMessages = _useState4[1];\n\n  useLayoutEffect(function () {\n    navigation.setOptions({\n      headerStyle: {\n        backgroundColor: \"#D50000\"\n      },\n      headerTitleStyle: {\n        color: \"#D50000\"\n      },\n      headerTintColor: \"white\",\n      headerBackTitleVisible: false,\n      headerRight: function headerRight() {\n        var _auth$currentUser, _auth$currentUser2;\n\n        return React.createElement(View, {\n          style: {\n            marginRight: 10,\n            flexDirection: \"row\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\"\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 19,\n            columnNumber: 9\n          }\n        }, React.createElement(Text, {\n          style: styles.chatTitle,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 20,\n            columnNumber: 11\n          }\n        }, route.params.chatName), React.createElement(TouchableOpacity, {\n          activeOpacity: 0.5,\n          style: {\n            marginLeft: 5\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 21,\n            columnNumber: 11\n          }\n        }, (auth == null ? void 0 : (_auth$currentUser = auth.currentUser) == null ? void 0 : _auth$currentUser.photoURL) === null ? React.createElement(SimpleLineIcons, {\n          name: \"user\",\n          size: 24,\n          color: \"white\",\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 23,\n            columnNumber: 56\n          }\n        }) : React.createElement(Avatar, {\n          rounded: true,\n          source: {\n            uri: auth == null ? void 0 : (_auth$currentUser2 = auth.currentUser) == null ? void 0 : _auth$currentUser2.photoURL\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 23,\n            columnNumber: 114\n          }\n        })));\n      }\n    });\n  }, [navigation]);\n\n  var sendMessage = function sendMessage() {\n    Keyboard.dismiss();\n    db.collection(\"chats\").doc(route.params.id).collection(\"messages\").add({\n      timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n      message: inputMessage,\n      displayName: auth.currentUser.displayName,\n      email: auth.currentUser.email,\n      photoURL: auth.currentUser.photoURL\n    });\n    console.log(db.collection(\"chats\").doc(route.params.id).collection(\"messages\"));\n    setInputMessage(\"\");\n  };\n\n  useLayoutEffect(function () {\n    var unsubscribe = db.collection(\"chats\").doc(route.params.id).collection(\"messages\").orderBy(\"timestamp\", \"desc\").onSnapshot(function (snapshot) {\n      return setMessages(snapshot.docs.map(function (doc) {\n        return {\n          id: doc.id,\n          data: doc.data()\n        };\n      }));\n    });\n    return unsubscribe;\n  }, [route]);\n  return React.createElement(SafeAreaView, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 5\n    }\n  }, React.createElement(KeyboardAvoidingView, {\n    behavior: Platform.OS === \"ios\" ? \"padding\" : \"height\",\n    style: styles.container,\n    keyboardVerticalOffset: 90,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }\n  }, React.createElement(TouchableWithoutFeedback, {\n    onPress: Keyboard.dismiss,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 9\n    }\n  }, React.createElement(React.Fragment, null, React.createElement(ScrollView, {\n    contentContainerStyle: {\n      paddingTop: 15\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }\n  }, messages.map(function (_ref2) {\n    var id = _ref2.id,\n        data = _ref2.data;\n    return data.email === auth.currentUser.email ? React.createElement(View, {\n      key: id,\n      style: styles.receiver,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 19\n      }\n    }, React.createElement(Avatar, {\n      position: \"absolute\",\n      bottom: -15,\n      right: -5,\n      rounded: true,\n      size: 30,\n      source: {\n        uri: data.photoURL\n      },\n      containerStyle: {\n        position: \"absolute\",\n        bottom: -15,\n        right: -5\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 21\n      }\n    }), React.createElement(Text, {\n      style: styles.receiverText,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 21\n      }\n    }, data.message)) : React.createElement(View, {\n      key: id,\n      style: styles.sender,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 21\n      }\n    }, React.createElement(Avatar, {\n      position: \"absolute\",\n      bottom: -15,\n      left: -5,\n      rounded: true,\n      size: 30,\n      source: {\n        uri: data.photoURL\n      },\n      containerStyle: {\n        position: \"absolute\",\n        bottom: -15,\n        left: -5\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 23\n      }\n    }), React.createElement(Text, {\n      style: styles.senderText,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 23\n      }\n    }, data.message), React.createElement(Text, {\n      style: styles.senderName,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 23\n      }\n    }, data.displayName));\n  })), React.createElement(View, {\n    style: styles.footer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }\n  }, React.createElement(TextInput, {\n    style: styles.message,\n    placeholder: \"Message\",\n    value: inputMessage,\n    onChangeText: function onChangeText(text) {\n      return setInputMessage(text);\n    },\n    onSubmitEditing: sendMessage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 15\n    }\n  }), React.createElement(TouchableOpacity, {\n    onPress: sendMessage,\n    activeOpacity: 0.5,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 15\n    }\n  }, React.createElement(Ionicons, {\n    name: \"send\",\n    type: \"antdesign\",\n    size: 30,\n    color: \"#D50000\",\n    required: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 17\n    }\n  })))))));\n};\n\nexport default ChatScreen;\nvar styles = StyleSheet.create({\n  chatTitle: {\n    color: \"#f0f\",\n    fontWeight: 'bold',\n    fontSize: 17\n  },\n  container: {\n    display: \"flex\",\n    bottom: 0\n  },\n  message: {\n    height: 40,\n    flex: 1,\n    marginRight: 15,\n    borderColor: \"#D50000\",\n    backgroundColor: \"white\",\n    borderWidth: 1,\n    color: \"#D50000\",\n    borderRadius: 50,\n    padding: 10\n  },\n  receiver: {\n    padding: 15,\n    backgroundColor: \"#ececec\",\n    alignSelf: \"flex-end\",\n    borderRadius: 20,\n    marginBottom: 20,\n    marginRight: 15,\n    maxWidth: \"80%\",\n    position: \"relative\"\n  },\n  receiverText: {\n    color: \"black\",\n    fontWeight: \"500\",\n    marginLeft: 10,\n    marginBottom: 15\n  },\n  sender: {\n    padding: 15,\n    backgroundColor: \"#D50000\",\n    alignSelf: \"flex-start\",\n    borderRadius: 20,\n    marginBottom: 20,\n    marginRight: 15,\n    maxWidth: \"80%\",\n    position: \"relative\"\n  },\n  senderText: {\n    color: \"white\",\n    fontWeight: \"500\",\n    marginLeft: 10,\n    marginBottom: 15\n  },\n  senderName: {\n    left: 10,\n    paddingRight: 10,\n    fontSize: 10,\n    color: \"white\"\n  },\n  footer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    width: \"100%\",\n    padding: 15\n  }\n});","map":{"version":3,"sources":["/Users/javierlopez/Desktop/Projects/hiMate/screens/ChatScreen.js"],"names":["React","useLayoutEffect","useState","AntDesign","SimpleLineIcons","Ionicons","auth","db","Avatar","firebase","ChatScreen","navigation","route","inputMessage","setInputMessage","messages","setMessages","setOptions","headerStyle","backgroundColor","headerTitleStyle","color","headerTintColor","headerBackTitleVisible","headerRight","marginRight","flexDirection","justifyContent","alignItems","styles","chatTitle","params","chatName","marginLeft","currentUser","photoURL","uri","sendMessage","Keyboard","dismiss","collection","doc","id","add","timestamp","firestore","FieldValue","serverTimestamp","message","displayName","email","console","log","unsubscribe","orderBy","onSnapshot","snapshot","docs","map","data","Platform","OS","container","paddingTop","receiver","position","bottom","right","receiverText","sender","left","senderText","senderName","footer","text","StyleSheet","create","fontWeight","fontSize","display","height","flex","borderColor","borderWidth","borderRadius","padding","alignSelf","marginBottom","maxWidth","paddingRight","width"],"mappings":"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","sourcesContent":["import React, { useLayoutEffect, useState } from 'react'\nimport { StyleSheet, View, TouchableOpacity, SafeAreaView, KeyboardAvoidingView, Platform, Keyboard, TouchableWithoutFeedback, ScrollView, TextInput, Text } from 'react-native'\nimport { AntDesign, SimpleLineIcons, Ionicons } from \"@expo/vector-icons\"\nimport { auth, db } from '../firebase'\nimport { Avatar } from 'react-native-elements'\nimport firebase from \"firebase\"\n\nconst ChatScreen = ({ navigation, route }) => {\n  const [inputMessage, setInputMessage] = useState(\"\")\n  const [messages, setMessages] = useState(\"\")\n\n  useLayoutEffect(() => {\n    navigation.setOptions({\n      headerStyle: { backgroundColor: \"#D50000\" },\n      headerTitleStyle: { color: \"#D50000\" },\n      headerTintColor: \"white\",\n      headerBackTitleVisible: false,\n      headerRight: () => (\n        <View style={{ marginRight: 10, flexDirection: \"row\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n          <Text style={styles.chatTitle}>{route.params.chatName}</Text>\n          <TouchableOpacity activeOpacity={0.5} style={{ marginLeft: 5 }}>\n            {\n              (auth?.currentUser?.photoURL === null) ? <SimpleLineIcons name=\"user\" size={24} color=\"white\" /> : <Avatar rounded source={{ uri: auth?.currentUser?.photoURL }} />\n            }\n          </TouchableOpacity>\n        </View>\n      ),\n    })\n  }, [navigation])\n\n  const sendMessage = () => {\n    Keyboard.dismiss()\n    db.collection(\"chats\").doc(route.params.id).collection(\"messages\").add(\n      {\n        timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n        message: inputMessage,\n        displayName: auth.currentUser.displayName,\n        email: auth.currentUser.email,\n        photoURL: auth.currentUser.photoURL\n      }\n    )\n    console.log(db.collection(\"chats\").doc(route.params.id).collection(\"messages\"))\n    setInputMessage(\"\")\n  }\n\n  useLayoutEffect(() => {\n    const unsubscribe = db\n      .collection(\"chats\")\n      .doc(route.params.id)\n      .collection(\"messages\")\n      .orderBy(\"timestamp\", \"desc\")\n      .onSnapshot((snapshot) =>\n        setMessages(\n          snapshot.docs.map(doc => ({\n            id: doc.id,\n            data: doc.data()\n          }))\n        )\n      )\n    return unsubscribe\n  }, [route])\n\n  return (\n    <SafeAreaView >\n      <KeyboardAvoidingView behavior={Platform.OS === \"ios\" ? \"padding\" : \"height\"} style={styles.container} keyboardVerticalOffset={90} >\n        <TouchableWithoutFeedback onPress={Keyboard.dismiss}>\n          <>\n            <ScrollView contentContainerStyle={{ paddingTop: 15 }}>\n              {messages.map(({ id, data }) =>\n                data.email === auth.currentUser.email ? (\n                  <View key={id} style={styles.receiver}>\n                    <Avatar position=\"absolute\" bottom={-15} right={-5} rounded size={30} source={{ uri: data.photoURL }}\n                      // WEB\n                      containerStyle={{\n                        position: \"absolute\",\n                        bottom: -15,\n                        right: -5\n                      }}\n                    />\n                    <Text style={styles.receiverText}>{data.message}</Text>\n                  </View>\n                ) : (\n                    <View key={id} style={styles.sender}>\n                      <Avatar position=\"absolute\" bottom={-15} left={-5} rounded size={30} source={{ uri: data.photoURL }}\n                        // WEB\n                        containerStyle={{\n                          position: \"absolute\",\n                          bottom: -15,\n                          left: -5\n                        }} />\n                      <Text style={styles.senderText}>{data.message}</Text>\n                      <Text style={styles.senderName}>{data.displayName}</Text>\n                    </View>\n                  )\n              )}\n            </ScrollView>\n            <View style={styles.footer}>\n              <TextInput style={styles.message} placeholder=\"Message\" value={inputMessage} onChangeText={(text) => setInputMessage(text)} onSubmitEditing={sendMessage} />\n              <TouchableOpacity onPress={sendMessage} activeOpacity={0.5}>\n                <Ionicons name=\"send\" type=\"antdesign\" size={30} color=\"#D50000\" required />\n              </TouchableOpacity>\n            </View>\n          </>\n        </TouchableWithoutFeedback>\n      </KeyboardAvoidingView>\n    </SafeAreaView >\n  )\n}\n\nexport default ChatScreen\n\nconst styles = StyleSheet.create({\n  chatTitle: {\n    color: \"#f0f\",\n    fontWeight: 'bold',\n    fontSize: 17\n  },\n  container: {\n    display: \"flex\",\n    // height: \"100%\",\n    bottom: 0,\n  },\n  message: {\n    height: 40,\n    flex: 1,\n    marginRight: 15,\n    borderColor: \"#D50000\",\n    backgroundColor: \"white\",\n    borderWidth: 1,\n    color: \"#D50000\",\n    borderRadius: 50,\n    padding: 10\n  },\n  receiver: {\n    padding: 15,\n    backgroundColor: \"#ececec\",\n    alignSelf: \"flex-end\",\n    borderRadius: 20,\n    marginBottom: 20,\n    marginRight: 15,\n    maxWidth: \"80%\",\n    position: \"relative\"\n  },\n  receiverText: {\n    color: \"black\",\n    fontWeight: \"500\",\n    marginLeft: 10,\n    marginBottom: 15\n  },\n  sender: {\n    padding: 15,\n    backgroundColor: \"#D50000\",\n    alignSelf: \"flex-start\",\n    borderRadius: 20,\n    marginBottom: 20,\n    marginRight: 15,\n    maxWidth: \"80%\",\n    position: \"relative\"\n  },\n  senderText: {\n    color: \"white\",\n    fontWeight: \"500\",\n    marginLeft: 10,\n    marginBottom: 15\n  },\n  senderName: {\n    left: 10,\n    paddingRight: 10,\n    fontSize: 10,\n    color: \"white\"\n  },\n  footer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    width: \"100%\",\n    padding: 15,\n  }\n})\n"]},"metadata":{},"sourceType":"module"}